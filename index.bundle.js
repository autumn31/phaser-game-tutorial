(()=>{"use strict";class t extends Phaser.Scene{constructor(){super({key:"mainScene"})}preload(){this.load.image("player","assets/player.png"),this.load.image("coin","assets/coin.png"),this.load.image("baddie","assets/baddie.png"),this.load.audio("bgm","assets/oedipus_ark_pandora.mp3"),this.load.audio("ping","assets/p-ping.mp3"),this.load.audio("death","assets/player_death.wav")}create(){this.input.keyboard.on("keydown-SPACE",function(t){this.gameOver?this.restart():this.speedUpReady&&(this.speedUpReady=!1,this.speedUpText.visible=!1,this.speedUp=!0,setTimeout(function(){this.speedUpReady=!0,this.speedUpText.visible=!0}.bind(this),1e4),setTimeout(function(){this.speedUp=!1}.bind(this),3e3))}.bind(this)),this.bgm||(this.bgm=this.sound.add("bgm",{loop:!0}),this.bgmOn=!0,this.soundOn=!0),this.bgmOn&&this.bgm.play(),this.bgmText=this.add.text(600,20,"Bgm: "+(this.bgmOn?"on":"off"),{font:"16px Arial",fill:"#fff"}),this.bgmText.setInteractive(new Phaser.Geom.Rectangle(0,0,this.bgmText.width,this.bgmText.height),Phaser.Geom.Rectangle.Contains),this.bgmText.on("pointerdown",function(){this.bgmOn?(this.bgmOn=!1,this.bgm.stop()):(this.bgmOn=!0,this.bgm.play()),this.bgmText.setText("Bgm: "+(this.bgmOn?"on":"off"))}.bind(this)),this.soundText=this.add.text(600,45,"Sound: "+(this.soundOn?"on":"off"),{font:"16px Arial",fill:"#fff"}),this.soundText.setInteractive(new Phaser.Geom.Rectangle(0,0,this.soundText.width,this.soundText.height),Phaser.Geom.Rectangle.Contains),this.soundText.on("pointerdown",function(){this.soundOn?this.soundOn=!1:this.soundOn=!0,this.soundText.setText("Sound: "+(this.soundOn?"on":"off"))}.bind(this)),this.speedUp=!1,this.speedUpReady=!0,this.speedUpText=this.add.text(20,50,"SpeedUp",{font:"16px Arial",fill:"#fde924"}),this.player=this.physics.add.sprite(100,100,"player"),this.coin=this.physics.add.sprite(300,200,"coin"),this.baddies=this.physics.add.group(),this.score=0,this.scoreText=this.add.text(20,20,"score: "+this.score,{font:"20px Arial",fill:"#fff"}),this.arrow=this.input.keyboard.createCursorKeys(),this.player.setCollideWorldBounds(!0),this.physics.add.collider(this.baddies,this.baddies),this.physics.add.overlap(this.player,this.coin,this.hit,null,this),this.physics.add.overlap(this.player,this.baddies,this.caught,null,this)}update(t,e){if(!this.gameOver){var s=1;this.speedUp&&(s=1.5),this.arrow.right.isDown?this.player.x+=3*s:this.arrow.left.isDown&&(this.player.x-=3*s),this.arrow.down.isDown?this.player.y+=3*s:this.arrow.up.isDown&&(this.player.y-=3*s),this.baddies.children.iterate((t=>{var e=this.player.x-t.x,s=this.player.y-t.y,i=Math.sqrt(e*e+s*s);0!=i&&t.setVelocity(e/i*100,s/i*100)}))}}hit(){if(this.soundOn&&this.sound.play("ping"),this.coin.x=Phaser.Math.Between(100,600),this.coin.y=Phaser.Math.Between(100,200),this.score+=10,this.scoreText.setText("score: "+this.score),this.tweens.add({targets:this.player,duration:200,scaleX:1.2,scaleY:1.2,yoyo:!0}),0!=this.score&&this.score%50==0){var t=Math.random()<.5?this.player.x-150:this.player.x+150,e=Math.random()<.5?this.player.y-50:this.player.y+50;this.baddies.create(t,e,"baddie")}}caught(t){this.soundOn&&this.sound.play("death"),this.bgm.stop(),this.physics.pause(),t.setTint(16711680),this.gameOver=!0;var e=this.add.text(250,120,"game over\n(Click or Space to restart)",{font:"20px Arial",fill:"#fff",align:"center"});e.setInteractive(new Phaser.Geom.Rectangle(0,0,e.width,e.height),Phaser.Geom.Rectangle.Contains),e.on("pointerdown",function(){this.restart()}.bind(this))}restart(){this.registry.destroy(),this.events.off(),this.gameOver=!1,this.physics.resume(),this.scene.restart(),this.player.disableBody(!0,!0),this.baddies.children.iterate((t=>{t.disableBody(!0,!0)}))}}class e extends Phaser.Scene{constructor(){super({key:"menuScene"})}preload(){}create(){var t=this.add.text(300,150,"Start Game",{font:"20px Arial",fill:"#fff",align:"center"});t.setInteractive(new Phaser.Geom.Rectangle(0,0,t.width,t.height),Phaser.Geom.Rectangle.Contains),t.on("pointerdown",function(){this.scene.switch("mainScene")}.bind(this))}update(t,e){}}new Phaser.Game({width:700,height:300,backgroundColor:"#3498db",scene:[e,t],audio:{disableWebAudio:!0},physics:{default:"arcade"},parent:"game"})})();